<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Unico Kitchen — Recipes, Shop & Gas</title>
<style>
:root{--accent:#ff6b35;--muted:#666;--bg:#fafafa}
*{box-sizing:border-box}
body{margin:0;font-family:Arial,system-ui,sans-serif;background:var(--bg);color:#111}
header{background:#fff;padding:12px;box-shadow:0 2px 8px rgba(0,0,0,.06);position:sticky;top:0;z-index:60}
.container{max-width:1000px;margin:0 auto;padding:12px}
.header-row{display:flex;align-items:center;gap:12px}
.brand{font-weight:800;color:var(--accent);font-size:18px}
.tabs{margin-left:20px;display:flex;gap:8px}
.tab{padding:8px 10px;border-radius:8px;cursor:pointer}
.tab.active{background:#fff;border:1px solid #eee;box-shadow:0 2px 8px rgba(0,0,0,.04)}
.actions{margin-left:auto;display:flex;gap:8px;align-items:center}
.count{background:var(--accent);color:#fff;padding:6px 10px;border-radius:999px;font-weight:700}
button{cursor:pointer;border:none;padding:8px 10px;border-radius:8px;background:var(--accent);color:#fff}
.ghost{background:#eee;color:#111}
main{padding:18px}
.quickbar{background:#fff;padding:8px 12px;border-bottom:1px solid #f3f3f3;display:flex;gap:12px;align-items:center;justify-content:center;flex-wrap:wrap}
.quick-item{display:flex;gap:8px;align-items:center;background:#fff;padding:6px;border-radius:8px;border:1px solid #f0f0f0}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
.card{background:#fff;padding:12px;border-radius:10px;box-shadow:0 4px 18px rgba(0,0,0,.04)}
.card img{width:100%;height:150px;object-fit:cover;border-radius:8px}
.buttons{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.hidden{display:none}
.shop-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}
.shop-item img{height:110px;width:100%;object-fit:cover;border-radius:8px}
.cart-panel{position:fixed;right:16px;bottom:16px;background:#fff;padding:12px;border-radius:10px;box-shadow:0 14px 40px rgba(0,0,0,.12);width:320px;max-height:70vh;overflow:auto;z-index:70}
.ingredient-row{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px dashed #f0f0f0}
footer{padding:16px;text-align:center;color:var(--muted);font-size:13px}
input[type=number]{padding:6px;border:1px solid #eee;border-radius:6px}
small.note{color:var(--muted);display:block;margin-top:6px}
@media (max-width:720px){.grid{grid-template-columns:1fr}.tabs{display:none}.cart-panel{width:92%;right:4%}}
</style>
</head>
<body>

<header>
  <div class="container header-row">
    <div style="display:flex;align-items:center;gap:12px">
      <img id="logo" src="images/logo.png" alt="logo" style="width:56px;height:56px;border-radius:10px;object-fit:cover">
      <div>
        <div class="brand">Unico Kitchen</div>
        <small class="note">You cook — we follow (recipes, shop & gas)</small>
      </div>
    </div>

    <nav class="tabs" id="navTabs">
      <div class="tab active" data-tab="recipes">Recipes</div>
      <div class="tab" data-tab="shop">Shop</div>
      <div class="tab" data-tab="gas">Gas</div>
      <div class="tab" data-tab="fridge">Fridge</div>
    </nav>

    <div class="actions">
      <div id="cartCount" class="count">0</div>
      <button id="openCartBtn" class="ghost">Cart</button>
      <button id="sendOrderHeader" class="ghost">Send Order</button>
    </div>
  </div>

  <div class="quickbar container" id="quickBar">
    <div style="font-weight:700;color:var(--muted)">Quick Buy:</div>
    <div id="quickItems" style="display:flex;gap:8px;align-items:center"></div>
    <div style="display:flex;gap:8px;align-items:center;margin-left:8px">
      <label style="font-size:14px">Gas:</label>
      <input id="quickGasQty" type="number" min="1" value="1" style="width:70px">
      <button id="quickAddGas">Add Gas</button>
    </div>
  </div>
</header>

<main class="container">
  <section id="recipes" class="tab-panel">
    <h2>Recipes</h2>
    <div id="recipesGrid" class="grid" style="margin-top:12px"></div>
  </section>

  <section id="shop" class="tab-panel hidden">
    <h2>Shop</h2>
    <div id="shopGrid" class="shop-grid" style="margin-top:12px"></div>
  </section>

  <section id="gas" class="tab-panel hidden">
    <h2>Gas Tokens</h2>
    <div style="background:#fff;padding:12px;border-radius:8px">
      <div style="display:flex;gap:10px;align-items:center">
        <label>Tokens: <input id="gasQty" type="number" min="1" value="1" style="width:80px"></label>
        <div>Price/token: <strong id="tokenPrice">50</strong> KES</div>
        <button id="addGas">Add</button>
      </div>
      <div style="margin-top:8px">Estimated: <strong id="gasTotal">50</strong> KES</div>
    </div>
  </section>

  <section id="fridge" class="tab-panel hidden">
    <h2>Your Fridge</h2>
    <div id="fridgeList" style="margin-top:12px"></div>
  </section>
</main>

<div id="cartPanel" class="cart-panel" style="display:none">
  <h3>Cart</h3>
  <div id="cartItems"></div>
  <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center">
    <div><strong>Total:</strong> <span id="cartTotal">0</span> KES</div>
    <div style="display:flex;gap:8px">
      <button id="clearCart" class="ghost">Clear</button>
      <button id="sendCart">Send Order</button>
    </div>
  </div>
</div>

<footer>Built for Unico Kitchen — edit JSON in <code>/data/</code> folder.</footer>

<script>
let CONFIG={},recipes=[],shopItems=[];
let cart=[],fridge=[];
const els={
  recipesGrid:document.getElementById('recipesGrid'),
  shopGrid:document.getElementById('shopGrid'),
  cartPanel:document.getElementById('cartPanel'),
  cartItems:document.getElementById('cartItems'),
  cartTotal:document.getElementById('cartTotal'),
  cartCount:document.getElementById('cartCount'),
  fridgeList:document.getElementById('fridgeList')
};

// Load JSONs
async function loadData(){
  const [c,r,s]=await Promise.all([
    fetch('data/config.json'),fetch('data/recipes.json'),fetch('data/shop-items.json')
  ]);
  CONFIG=await c.json();recipes=await r.json();shopItems=await s.json();
  document.getElementById('tokenPrice').textContent=CONFIG.TOKEN_PRICE;
  renderRecipes();renderShop();renderQuickbar();updateCart();
}

// Render Recipes
function renderRecipes(){
  els.recipesGrid.innerHTML=recipes.map(r=>`
    <div class="card">
      <img src="${r.image}" alt="${r.title}">
      <h3>${r.title}</h3>
      <small>${r.time||''}</small>
      <div class="buttons">
        <button onclick="sendRecipe('${r.title}')">Cook (WhatsApp)</button>
      </div>
    </div>`).join('');
}

// Render Shop
function renderShop(){
  els.shopGrid.innerHTML=shopItems.map(i=>`
    <div class="card shop-item">
      <img src="${i.image}" alt="${i.name}">
      <div>${i.name}</div>
      <div><strong>${i.price}</strong> KES</div>
      <div class="buttons">
        <button onclick="addToCart('${i.id}')">Add to Cart</button>
        <button class="ghost" onclick="addToFridge('${i.id}')">Add to Fridge</button>
      </div>
    </div>`).join('');
}

// Render Quickbar
function renderQuickbar(){
  const q=document.getElementById('quickItems');
  q.innerHTML=CONFIG.featuredShopIds.map(id=>{
    const i=shopItems.find(x=>x.id===id);
    return `<div class="quick-item">
      <button onclick="addToCart('${i.id}')">${i.name}</button>
    </div>`;
  }).join('');
}

// Cart + Fridge
function addToCart(id){
  const item=shopItems.find(i=>i.id===id);
  const existing=cart.find(i=>i.id===id);
  if(existing) existing.qty++; else cart.push({...item,qty:1});
  updateCart();
}
function updateCart(){
  els.cartItems.innerHTML=cart.map(i=>`
    <div class="ingredient-row">
      <span>${i.name} × ${i.qty}</span>
      <span>${i.price*i.qty} KES</span>
    </div>`).join('');
  const total=cart.reduce((a,i)=>a+i.price*i.qty,0);
  els.cartTotal.textContent=total;
  els.cartCount.textContent=cart.length;
}
function addToFridge(id){
  if(!fridge.includes(id)) fridge.push(id);
  renderFridge();
}
function renderFridge(){
  els.fridgeList.innerHTML=fridge.map(id=>{
    const i=shopItems.find(x=>x.id===id);
    return `<div class="ingredient-row">
      <span>${i.name}</span><button onclick="addToCart('${i.id}')">View in Shop</button>
    </div>`;
  }).join('')||'<p>No ingredients yet.</p>';
}

// Gas
document.getElementById('addGas').onclick=()=>{
  const qty=+document.getElementById('gasQty').value;
  const price=CONFIG.TOKEN_PRICE*qty;
  cart.push({id:'gas',name:`Gas Tokens (${qty})`,price,qty:1});
  updateCart();
};
document.getElementById('gasQty').oninput=()=>{
  const qty=+document.getElementById('gasQty').value;
  document.getElementById('gasTotal').textContent=CONFIG.TOKEN_PRICE*qty;
};

// WhatsApp Senders
function sendRecipe(title){
  const url=`https://wa.me/${CONFIG.PHONE}?text=I'd like to cook: ${title}`;
  window.open(url,'_blank');
}
document.getElementById('sendCart').onclick=sendOrder;
document.getElementById('sendOrderHeader').onclick=sendOrder;
function sendOrder(){
  if(cart.length===0)return alert("Cart empty!");
  const msg=cart.map(i=>`${i.name} ×${i.qty}`).join('%0A');
  const url=`https://wa.me/${CONFIG.PHONE}?text=Unico Order:%0A${msg}%0AThank you!`;
  window.open(url,'_blank');
}

// Tabs + Cart toggle
document.querySelectorAll('.tab').forEach(t=>{
  t.onclick=()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    document.querySelectorAll('.tab-panel').forEach(x=>x.classList.add('hidden'));
    t.classList.add('active');
    document.getElementById(t.dataset.tab).classList.remove('hidden');
  };
});
document.getElementById('openCartBtn').onclick=()=>{
  els.cartPanel.style.display=els.cartPanel.style.display==='none'?'block':'none';
};
document.getElementById('clearCart').onclick=()=>{cart=[];updateCart();};

loadData();
</script>
</body>
</html>
